<!DOCTYPE html>
<html>
<head>
    <meta charset='UTF-8'>
    <title>Operational Expense Breakdown</title>
    <script src='https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js'></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #FEF8EF; color: #333333; }
        .chart-container { width: 1000px; height: 600px; margin: 40px auto; padding: 30px; background: #ffffff; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border: 1px solid #ccc; }
        .chart-title { text-align: center; font-size: 20px; font-weight: bold; margin-bottom: 25px; color: #333333; }
    </style>
</head>
<body>
    <div class='chart-container'>
        <div class='chart-title'>Operational Expense Breakdown</div>
        <div id='chartBox' style='width: 100%; height: 90%;'></div>
    </div>
    <script>
    var currentFilename = 'Chart_Pie.html';
    var currentTitle = 'Operational Expense Breakdown';
    const colors = ['#d87c7c','#919e8b','#d7ab82','#6e7074','#61a0a8','#efa18d','#787464','#cc7e63','#724e58','#4b565b'];
        var myChart = echarts.init(document.getElementById('chartBox'), null, {renderer: 'canvas'});
        var toolboxFeatures = {
             myEditLabels: {
                 show: true, title: 'Edit Title', icon: 'path://M17.8,2l2.2,2.2c0.3,0.3,0.3,0.7,0,1l-1.3,1.3l-3.2-3.2l1.3-1.3C17.1,1.7,17.5,1.7,17.8,2z M14.3,3.9l3.2,3.2L5.4,19.3H2.2v-3.2L14.3,3.9z',
                 onclick: function() {
                     var t = prompt('Enter Chart Title:', currentTitle);
                     if(t !== null) currentTitle = t;
                     document.querySelector('.chart-title').innerText = currentTitle;
                 }
             },
             mySaveConfig: {
                 show: true, title: 'Save Config', icon: 'path://M15,1H3C1.9,1,1,1.9,1,3v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5L15,1z M9,17H5v-5h4V17z M15,17h-4v-5H5v5H3V3h2v4h8V3h1.2L17,5.8V17H15z',
                 onclick: function() {
                     var htmlContent = document.documentElement.outerHTML;
                     htmlContent = htmlContent.replace(/var currentTitle = '.*?';/, "var currentTitle = '" + currentTitle + "';");
                     var blob = new Blob([htmlContent], {type: 'text/html'});
                     var a = document.createElement('a');
                     a.href = URL.createObjectURL(blob);
                     a.download = currentFilename;
                     a.click();
                 }
             },
             mySaveImage: {
                 show: true, title: 'Save Image (Full Card)', icon: 'path://M19,3H5C3.9,3,3,3.9,3,5v14c0,1.1,0.9,2,2,2h14c1.1,0,2-0.9,2-2V5C21,3.9,20.1,3,19,3z M5,19V5h14v14H5z M13.5,13.5l-2.5,3l-1.5-2l-2.5,3h9L13.5,13.5z',
                 onclick: function() {
                     myChart.setOption({ toolbox: { show: false } });
                     setTimeout(function() {
                         html2canvas(document.querySelector('.chart-container'), {backgroundColor: '#ffffff'}).then(function(canvas) {
                             var a = document.createElement('a');
                             a.href = canvas.toDataURL('image/png');
                             a.download = currentFilename.replace('.html', '.png');
                             a.click();
                             myChart.setOption({ toolbox: { show: true } });
                         });
                     }, 100);
                 }
             },
             restore: { show: true, title: 'Restore' },
             dataView: { show: true, title: 'Data View' }
        };
        var option = {
            backgroundColor: '#ffffff',
            color: colors,
            animation: true,
            title: { show: false, text: currentTitle },
            tooltip: {
                show: true, trigger: 'item', 
                textStyle: {fontSize: 14, color: '#333333'}, borderWidth: 0, padding: 5,
            },
            toolbox: {
                show: true, orient: 'horizontal', itemSize: 15, itemGap: 10, left: '75%',
                feature: toolboxFeatures,
            },
            legend: {
                show: true, type: 'scroll', left: 'center', top: 'top', padding: [0,0,20,0], itemGap: 10,
                textStyle: { fontFamily: 'Arial', fontSize: 12, color: '#333333' },
                pageIconColor: '#2f4554', pageIconInactiveColor: '#aaa'
            },
            series: [{
                type: 'pie', 
                name: 'Amount', 
                radius: '75%', 
                center: ['50%', '55%'], 
                data: [{ name: "Rent", value: 12000 },{ name: "Utilities", value: 5000 },{ name: "Salaries", value: 55000 },{ name: "Office Supplies", value: 3000 },{ name: "Miscellaneous", value: 2000 }],
                label: {
                    show: true, formatter: function(params) { var currency_symbol = '\u20B9'; var number = params.value; if(number < 1000) { return params.name + ': ' + currency_symbol + number.toFixed(0) + ' (' + params.percent + '%)'; } var magnitude = Math.floor((Math.log(number) / Math.log(1000))); var result = currency_symbol + (number / Math.pow(1000, magnitude)).toFixed(1) + ['', 'K', 'M', 'B', 'T'][magnitude]; return params.name + ': ' + result + ' (' + params.percent + '%)';}, color: '#333333', fontFamily: 'Arial', fontSize: 12
                },
                emphasis: {
                    itemStyle: { shadowBlur: 10, shadowOffsetX: 0, shadowColor: 'rgba(0, 0, 0, 0.5)' }
                }
            }]
        };
        myChart.setOption(option);
        window.addEventListener('resize', function() { myChart.resize(); });
    </script>
</body></html>
